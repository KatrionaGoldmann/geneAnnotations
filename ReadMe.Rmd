---
title: "geneAnnotations"
author: "Katriona Goldmann"
date: "3/7/2021"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(omicAnnotations)
```


# omicAnnotations

This package annotates SNPs and gene names for available databases and API.
In particular this uses databases by:

<div style="text-align: center;">
<img src="https://www.ebi.ac.uk/eccb/2016/wp-content/uploads/2016/03/EMBL-EBI.png" alt="EBI" height="100" style="margin:5px;"/>
<img src="https://pbs.twimg.com/profile_images/1102971554097438721/jlBwbq2-_400x400.png" alt="EMR" height="100" style="margin:5px;"/>
<img src="https://lw-static-files.s3.amazonaws.com/public/logos/2688.png" alt="enrichr" height="100" style="margin:5px;"/>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/07/US-NLM-NCBI-Logo.svg/1200px-US-NLM-NCBI-Logo.svg.png" alt="ncbi" height="70" style="margin:5px; margin-bottom:25px;"/>
<img src="https://lh4.googleusercontent.com/bQslJhi8fXIPK_Q7FII6M34DJrFriAt3paXvwuam_QfBvyaETGbdVn6qOqyQ-N9oVMqOXzeNbpLLeJKqM-q6CNal0gyeE-u-UnB52_BJK895wJES_XZO-UlcEVPDNj2qTArWGgP_" alt="gtex" height="70" style="margin:5px;"/>
<img src="https://miro.medium.com/max/1200/1*09zn4xwEeADS3c4V5QUiRA.png" alt="pubmed" height="50" style="margin:5px;"/>
</div>


To install: 

```{r, eval=FALSE}
devtools::install_github("KatrionaGoldmann/omicAnnotations")
```

## Gene Annotations

For example for the entire gene summary: 

```{r}
gene_df <- gene_summary(genes=c("FMOD", "FGF1", "SLAMF6"), diseases="C20")
```


```{r}
kable(gene_df, format = "markdown", row.names = FALSE)
```

### Publications

You can check for publications focusing on genes with given terms. Either 
using `associated_publications`:

```{r}
gene_pubs <- associated_publications(genes=c("FGF1"), 
                                     keywords=c("rheumatoid"), 
                                     split="OR", 
                                     verbose=TRUE)

kable(gene_pubs, format = "markdown", row.names=FALSE)
```


Or `gene_summary`: 

```{r}
gene_df <- gene_summary(genes=c("FGF1"), 
                        associated_diseases = FALSE,
                        gene_description=FALSE, 
                        publications = TRUE)

kable(gene_df, format = "markdown", row.names=FALSE)
```

### Enriched pathways

Looks for enriched pathways with gene sets using [enrichR](https://maayanlab.cloud/Enrichr/).

```{r, eval=FALSE}
lymphoid_pathways <- enriched_pathways(
  genes=c("LAMP5", "LINC01480", "FAM92B", "SLAMF6", "CEP128",
          "FKBP11", "CRTAM", "ISG20", "ZBP1", "TMEM229B",
          "FAM46C", "XBP1", "APOBEC3G", "TNIK", "CD2", "SP140",
          "ACOXL", "PTPRCAP", "PDCD1", "KCNN3", "GZMK",
          "IGFLR1", "SH2D2A", "PIM2", "TPST2"),
  libraries = c('Pathways'),
  dbs=NULL,
  check_for_updates = FALSE)
```

If that doesn't work it may be because the website is down. This happens occasionsally. You can check by using: 

```{r, eval=FALSE}
listEnrichrDbs()
```

```{r, include=FALSE}
data("lymphoid_pathways")
```

Plots

```{r}
lymphoid_pathways$plot
```

### eQTL Catalogue

```{r}
eqtl_table <- associated_eqtl(genes=c("ENSG00000164308"), p_cutoff=1)
kable(eqtl_table, row.names=F) 
```

## SNP Annotations

omicAnnotations can also be used to find out more info about SNPs.

### GWAS Catalogue

```{r}
gwas_traits <- associated_traits(snps = c("rs2910686", "rs7329174"))

kable(gwas_traits, row.names = F) 
```

### eQTL Catalogue

```{r}
eqtl_table <- associated_eqtl(snps = c("rs2910686", "rs7329174"),
                              p_cutoff = 0.05)

kable(eqtl_table, row.names = F) 
```


### GTex 

```{r}
g2s <- data.frame("Genes"=c("ERAP2", "ERAP2", "HLA-DRB9"), 
                  "Snps"=c("chr5_96916728_G_A", "chr5_96916885_T_C", 
                           "chr6_32620055_A_G"))

df <- gtex_eqtl(gene_snp_pairs = g2s)
```

```{r, fig.height=10, message=FALSE}
library(ComplexHeatmap)

hm <- gtex_heatmap(df)
draw(hm, heatmap_legend_side = "left")
```